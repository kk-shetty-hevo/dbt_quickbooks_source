select
	to_timestamp("__HEVO__LOADED_AT" / 1000) as last_synced,
	"ACTIVE" as active,
	json_extract_path_text("ALTERNATE_PHONE", 'freeFormNumber') as alternate_phone_number,
	Null as ar_account_id,
	"BALANCE" as balance,
	"BALANCE_WITH_JOBS" as balance_with_jobs,
	json_extract_path_text("BILL_ADDR", 'id') as bill_address_id,
	"BILL_WITH_PARENT" as bill_with_parent,
	"COMPANY_NAME" as company_name,
	to_timestamp(
        json_extract_path_text("META_DATA", 'createTime')::number / 1000
    ) as created_at,
	json_extract_path_text("CURRENCY_REF", 'value') as currency_id,
	json_extract_path_text("DEFAULT_TAX_CODE_REF", 'value') as default_tax_code_id,
	"DISPLAY_NAME" as display_name,
	json_extract_path_text("PRIMARY_EMAIL_ADDR", 'address') as email,
	"FAMILY_NAME" as family_name,
	json_extract_path_text("FAX", 'number') as fax_number,
	"FULLY_QUALIFIED_NAME" as fully_qualified_name,
	"GIVEN_NAME" as given_name,
	"ID" as id,
	"JOB" as job,
	Null as level,
	"MIDDLE_NAME" as middle_name,
	json_extract_path_text("MOBILE", 'freeFormNumber') as mobile_number,
	"NOTES" as notes,
	Null as open_balance_date,
	Null as parent_customer_id,
	json_extract_path_text("PAYMENT_METHOD_REF", 'value') as payment_method_id,
	json_extract_path_text("PRIMARY_PHONE", 'freeFormNumber') as phone_number,
	"PREFERRED_DELIVERY_METHOD" as preferred_delivery_method,
	"PRINT_ON_CHECK_NAME" as print_on_check_name,
	Null as resale_number,
	Null as sales_term_id,
	json_extract_path_text("SHIP_ADDR", 'id') as shipping_address_id,
	"SUFFIX" as suffix,
	"SYNC_TOKEN" as sync_token,
	Null as tax_exemption_reason_id,
	"TAXABLE" as taxable,
	"TITLE" as title,
	to_timestamp(
        json_extract_path_text("META_DATA", 'lastUpdatedTime')::number / 1000
    ) as updated_at,
	Null as website
from 
    {{ var('customer') }}